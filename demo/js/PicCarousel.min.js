!function(t){var e=function(){function e(e,s){this.settings=t.extend(!0,t.fn.PicCarousel.defaults,s||{}),this.element=e,this.init()}return e.prototype={init:function(){var e=this;this.currentIndex=0,this.poster=this.element,this.posterItemMain=this.poster.find("ul.poster-list"),this.nextBtn=this.poster.find("div.poster-next-btn"),this.prevBtn=this.poster.find("div.poster-prev-btn"),this.posterItems=this.poster.find("li.poster-item"),this.posterItems.size()%2==0&&(this.posterItemMain.append(this.posterItems.eq(0).clone()),this.posterItems=this.posterItemMain.children()),this.posterFirstItem=this.posterItems.first(),this.posterLastItem=this.posterItems.last(),this.rotateFlag=!0,this.setSettingValue(),this.setPosterPost(),this.nextBtn.click(function(){e.rotateFlag&&(e.rotateFlag=!1,e.carouseRotate(-1))}),this.prevBtn.click(function(){e.rotateFlag&&(e.rotateFlag=!1,e.carouseRotate(1))}),this.poster.on("swipe",function(t,s){"left"===s?e.nextBtn.click():e.prevBtn.click()}),this.bindSwipe(),this.posterItems.click(function(){var s=t(this).data("index")-e.currentIndex,i=t(this).data("index")-e.posterItems.size()-e.currentIndex,n=Math.abs(s)<Math.abs(i)?-1*s:-1*i;e.carouseRotate(n)}),this.settings.autoPlay&&(this.autoPlay(),this.poster.on("touchstart, mouseover",function(){window.clearInterval(e.timer)}).on("touchend, mouseout",function(){e.autoPlay()}))},autoPlay:function(){var t=this;t.timer&&window.clearInterval(t.timer),t.timer=window.setInterval(function(){t.nextBtn.click()},t.settings.delay)},bindSwipe:function(){var t,e,s,i,n=this;n.poster.on("touchstart",function(s){t=s.touches[0].clientX,e=s.touches[0].clientY}),n.poster.on("touchmove",function(t){s=t.touches[0].clientX,i=t.touches[0].clientY}),n.poster.on("touchend",function(o){s-=t,i-=e,Math.abs(s)-Math.abs(i)>20&&(s>0?n.poster.trigger("swipe","right"):n.poster.trigger("swipe","left"))})},getTargetIndex:function(t,e,s){var i=t+e;return i<0?s+i:i>=s?i-s:i},carouseRotate:function(e){var s=this,i=[];0!==e&&(s.posterItems.each(function(n){var o=t(this),r=s.getTargetIndex(n,e,s.posterItems.length),h=s.posterItems.eq(r),a=h.width(),c=h.height(),l=h.css("zIndex"),p=h.css("opacity"),d=h.css("left"),u=h.css("top");i.push({zIndex:l,width:a,height:c,opacity:p,left:d,top:u,transition:"all "+s.settings.speed/1e3+"s ease","-webkit-transition":"all "+s.settings.speed/1e3+"s ease"}),o.one("transitionend webkitTransitionEnd",function(){o.off("transitionend webkitTransitionEnd"),s.rotateFlag=!0})}),s.posterItems.each(function(e){t(this).css(i[e])}),0===this.currentIndex&&(this.currentIndex=this.posterItems.size()),this.currentIndex-=e,this.currentIndex%=this.posterItems.size())},setPosterPost:function(){var e=this,s=e.posterItems.slice(1),i=s.size()/2,n=s.slice(0,i),o=Math.floor(e.posterItems.size()/2),r=s.slice(i),h=e.settings.posterWidth,a=e.settings.posterHeight,c=(e.settings.width-e.settings.posterWidth)/2/o,l=(e.settings.width-e.settings.posterWidth)/2+h;n.each(function(s){o--,h*=e.settings.scale,a*=e.settings.scale;var i=s;t(this).css({zIndex:o,width:h,height:a,opacity:1/++i,left:l+ ++s*c-h,top:e.setVertucalAlign(a)})});var p=n.last().width(),d=n.last().height(),u=Math.floor(e.posterItems.size()/2);r.each(function(s){t(this).css({zIndex:s,width:p,height:d,opacity:1/u,left:s*c,top:e.setVertucalAlign(d)}),p/=e.settings.scale,d/=e.settings.scale,u--})},setVertucalAlign:function(t){var e=this.settings.verticalAlign;return"middle"===e?(this.settings.height-t)/2:"top"===e?0:"bottom"===e?this.settings.height-t:(this.settings.height-t)/2},setSettingValue:function(){var e=this;e.poster.css({width:e.settings.width,height:e.settings.height}),e.posterItems.each(function(e,s){t(s).data("index",e)}),e.posterItemMain.css({width:e.settings.width,height:e.settings.height});var s=(e.settings.width-e.settings.posterWidth)/2;e.nextBtn.css({width:s,height:e.settings.height,zIndex:Math.ceil(e.posterItems.size()/2)}),e.prevBtn.css({width:s,height:e.settings.height,zIndex:Math.ceil(e.posterItems.size()/2)}),e.posterFirstItem.css({width:e.settings.posterWidth,height:e.settings.posterHeight,top:e.setVertucalAlign(e.settings.posterHeight),left:s,zIndex:Math.floor(e.posterItems.size()/2)})}},e}();t.fn.PicCarousel=function(s){return this.each(function(){var i=t(this),n=i.data("PicCarousel");n||(n=new e(i,s),i.data("PicCarousel",n))})},t.fn.PicCarousel.defaults={width:1e3,height:300,posterWidth:520,posterHeight:300,scale:.9,speed:300,autoPlay:!1,delay:500,verticalAlign:"middle"}}(jQuery);